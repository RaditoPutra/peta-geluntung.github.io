// --- PUSAT PETA & TINGKAT ZOOM ---
const pusatDesaGeluntung = [-8.45413, 115.16835];
const tingkatZoomAwal = 15;

// --- INISIALISASI PETA ---
const mymap = L.map('mapid').setView(pusatDesaGeluntung, tingkatZoomAwal);

// --- TAMBAHKAN TILE LAYER ---
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(mymap);

// --- TAMBAHKAN MARKER (Penanda Lokasi) ---
const koordinatKantorDesa = [-8.45688550301095, 115.17126125700298];
L.marker(koordinatKantorDesa)
    .addTo(mymap)
    .bindPopup('<b>Kantor Perbekel Desa Geluntung</b><br>Pusat Pemerintahan Desa.')
    .openPopup();

const koordinatSDGeluntung = [-8.458973, 115.170333];
L.marker(koordinatSDGeluntung)
    .addTo(mymap)
    .bindPopup('<b>SDN 1 Geluntung</b><br>Sekolah Dasar Negeri Geluntung.');

// --- MENAMBAHKAN POLYGON ---
const koordinatPolygonSawah = [
    [-8.452054765230011, 115.1615312873761],
    [-8.452283965716168, 115.16206789559934],
    // ... sisa koordinat Anda
    [-8.452274200284698, 115.16143923932059]
];

L.polygon(koordinatPolygonSawah, {
    color: 'green',
    fillColor: '#32a852',
    fillOpacity: 0.4
}).addTo(mymap).bindPopup('Area Persawahan');


// --- KODE BARU: MEMBUAT LEGEND PETA ---
const legend = L.control({ position: 'bottomleft' });

legend.onAdd = function (map) {
    const div = L.DomUtil.create('div', 'info legend');
    const labels = [
        '<strong>Legenda</strong>'
    ];
    
    // URL untuk ikon marker biru default dari Leaflet
    const markerIconUrl = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png';

    // Item untuk Lokasi Penting (Marker)
    labels.push(
        '<img src="' + markerIconUrl + '"> Lokasi Penting'
    );

    // Item untuk Area Persawahan (Polygon)
    labels.push(
        '<i style="background: #32a852"></i> Area Persawahan'
    );

    div.innerHTML = labels.join('<br>');
    return div;
};

legend.addTo(mymap);
